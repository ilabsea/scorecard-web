= render "shared/page_title", title: t('user.users'), url: new_user_path, label: t('user.add_new')

.card.shadow.mb-4
  .card-body
    = render 'filter'
    = render partial: "shared/no_data", locals: { items: @users }

    = render "shared/pagination_title", objects: @users

    - if @users.present?
      %table.table.table-hover.pretty
        %thead
          %tr
            %th= sortable "id", t('shared.number')
            %th= sortable "email", t("user.email")
            %th= sortable "role", t("user.role")
            %th= t('user.program')
            %th= t('user.status')
            %th

        %tbody
          - @users.each_with_index do |user, index|
            %tr
              %td= user.id
              %td= user.email
              %td= user.role.titlecase
              %td= user.program_name

              %td.status{ class: ('active' if user.confirmed?) }
                = user.confirmed? ? t('user.active') : t('user.pending')

              %td.text-right
                - if policy(user).destroy?
                  - unless user.confirmed?
                    %input.confirm-link{ value: confirmation_url(user, confirmation_token: user.confirmation_token) }

                    = link_to '#', class: "btn btn-circle btn-sm btn-info mr-2 btn-copy", data: { toggle: 'tooltip', placement: 'top', title: t('user.copy_confirm_link') } do
                      %i.far.fa-copy

                  = render 'shared/action_buttons', edit_url: edit_user_path(user), delete_url: user_path(user), object: user

      - if @pagy.pages > 1
        .pagy-wrapper
          != pagy_bootstrap_nav(@pagy)

= render "shared/toast_copy"
