%table.table.table-bordered
  %thead
    %tr
      %th.align-middle.text-center{:scope => "col"}= t("scorecard.indicator")
      %th.align-middle.text-center{:scope => "col"}= t("scorecard.median")
      %th.align-middle.text-center{:scope => "col"}= t("scorecard.strength")
      %th.align-middle.text-center{:scope => "col"}= t("scorecard.weakness")
      %th.align-middle.text-center{:scope => "col"}= t("scorecard.suggested_action")

  %tbody
    - @voting_indicators.each_with_index do |vi, index|
      %tr
        %td.text-break= "#{index + 1}) #{vi.indicator.name}"
        %td.text-center= VotingIndicator.medians[vi.median]

        - ['strength', 'weakness', 'suggested'].each do |action|
          %td
            %ul.text-break
              - vi.send("#{action}_indicator_activities").each do |activity|
                %li
                  - if policy(@scorecard).in_review?
                    .d-flex
                      - tooltip_title = activity.selected? ? t("scorecard.edit_selected_action") : t("shared.edit")
                      .d-flex.align-items-start{data: { toggle: 'tooltip', placement: 'top', title: tooltip_title }}
                        = best_in_place activity, :content, url: scorecards_indicator_activity_path(activity), as: :input, class: [('text-info' if activity.selected?), 'inline-edit'], param: 'indicator_activity'

                        %span
                          %i.fas.fa-pen.btn-sm.text-warning.edit-icon
                  - else
                    - data_attr = !activity.selected? ? {} : { class: 'text-info', data: { toggle: 'tooltip', placement: 'top', title: t('scorecard.selected_action') } }

                    %span{data_attr}= activity.content

- if references = @scorecard.scorecard_references.presence
  .mb-2
    %label= t('scorecard.references')
    - references.each do |ref|
      %div
        %a.btn.btn-link{href: ref.attachment_url, download: true, target: '_blank'}
          %i.fas.fa-cloud-download-alt
          %span= ref.attachment_identifier
